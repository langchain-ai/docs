LangChain Agent Auth enables secure access from agents to other systems via OAuth 2.0 credentials. With LangChain Agent Auth, build your agents to securely connect to any system on your behalf.

## Overview

LangChain Agent Auth is designed to solve the challenge of secure authentication for autonomous agents. Instead of embedding credentials directly in agent code or requiring manual intervention for each API call, agents can use the OAuth flow to obtain time-limited access tokens for external services.

The system consists of:
- **Authentication Server**: Manages OAuth flows and stores credentials securely
- **Client SDK**: Python library for easy integration with agents

## Installation

Install the client SDK:

```bash
pip install langchain-auth
```

For use with LangGraph:
```bash
pip install 'langchain-auth[langgraph]'
```

## Quick Start

### 1. Initialize the Client

```python
from langchain_auth import Client

client = Client(api_key="your-langsmith-api-key")
```

### 2. Set Up OAuth Providers

Before agents can authenticate, you need to configure OAuth providers:

```python
# Create GitHub provider
github_provider = await client.create_oauth_provider(
    provider_id="github",
    name="GitHub",
    client_id="your-github-client-id",
    client_secret="your-github-client-secret",
    auth_url="https://github.com/login/oauth/authorize",
    token_url="https://github.com/login/oauth/access_token",
    user_info_url="https://api.github.com/user",
    scopes=["repo"] # Provide one or more scopes you would like to be available for this provider
)
```

### 3. Authenticate from Agent

```python
auth_result = await client.authenticate(
    provider="github",
    scopes=["repo"],
    user_id="{CALLING_USER_ID}" # Any unique identifier for the human user calling this agent
)

if not auth_result.needs_auth:
    pass # Use auth_result.token for api calls to the service
```

## Usage Examples

### From a LangGraph Agent

When running inside a LangGraph context, the authentication flow uses interrupts for a seamless user experience:

```python
from langchain_auth import Client
from langgraph.graph import StateGraph

def create_agent_with_auth():
    client = Client(api_key="your-api-key")
    
    async def authenticate_node(state):
        # This will interrupt and prompt user for OAuth
        auth_result = await client.authenticate(
            provider="github",
            scopes=["repo"],
            user_id=state["user_id"]
        )
        
        # When resumed, token will be available
        state["github_token"] = auth_result.token
        return state
    
    # Add to your LangGraph workflow
    graph = StateGraph(...)
    graph.add_node("auth", authenticate_node)
    return graph.compile()
```

### Outside of LangGraph Context

Here's a basic agent that uses GitHub authentication outside of LangGraph:

```python
import asyncio
from langchain_auth import Client

async def simple_github_agent():
    """A simple agent that authenticates with GitHub and fetches user info."""
    client = Client(api_key="your-api-key")
    
    try:
        # Authenticate with GitHub
        auth_result = await client.authenticate(
            provider="github",
            scopes=["read:user"],
            user_id="agent_user"
        )
        
        # Handle OAuth flow if needed
        if auth_result.needs_auth:
            print(f"Please complete OAuth at: {auth_result.auth_url}")
            auth_result = await client.wait_for_completion(auth_result.auth_id)
        
        # Now we have a token - agent can use it for GitHub API calls
        token = auth_result.token
        print(f"Agent authenticated successfully!")
        
        # Example: Use token with GitHub API
        import httpx
        async with httpx.AsyncClient() as http_client:
            response = await http_client.get(
                "https://api.github.com/user",
                headers={"Authorization": f"Bearer {token}"}
            )
            user_data = response.json()
            print(f"Authenticated as: {user_data['login']}")
        
    finally:
        await client.close()

# Run the agent
asyncio.run(simple_github_agent())
```
