---
title: "Cohere"
---

> [Cohere](https://cohere.ai/about) is a Canadian startup that provides natural language processing models that help companies improve human-machine interactions.

## Installation and Setup

* Install the Python SDK :

```
pip install langchain-cohere
```

Get a [Cohere api key](https://dashboard.cohere.ai/) and set it as an environment variable (`COHERE_API_KEY`)

## Cohere langchain integrations

| API              | description                      | Endpoint docs                                          | Import                                                               | Example usage                                                  |
| ---------------- | -------------------------------- | ------------------------------------------------------ | -------------------------------------------------------------------- | -------------------------------------------------------------- |
| Chat             | Build chat bots                  | [chat](https://docs.cohere.com/reference/chat)         | `from langchain_cohere import ChatCohere`                            | [cohere.ipynb](/src/oss/integrations/chat/cohere)                |
| LLM              | Generate text                    | [generate](https://docs.cohere.com/reference/generate) | `from langchain_cohere.llms import Cohere`                           | [cohere.ipynb](/src/oss/integrations/llms/cohere)                |
| RAG Retriever    | Connect to external data sources | [chat + rag](https://docs.cohere.com/reference/chat)   | `from langchain.retrievers import CohereRagRetriever`                | [cohere.ipynb](/src/oss/integrations/retrievers/cohere)          |
| Text Embedding   | Embed strings to vectors         | [embed](https://docs.cohere.com/reference/embed)       | `from langchain_cohere import CohereEmbeddings`                      | [cohere.ipynb](/src/oss/integrations/text_embedding/cohere)      |
| Rerank Retriever | Rank strings based on relevance  | [rerank](https://docs.cohere.com/reference/rerank)     | `from langchain.retrievers.document_compressors import CohereRerank` | [cohere.ipynb](/src/oss/integrations/retrievers/cohere-reranker) |

## Quick copy examples

### Chat

```
from langchain_cohere import ChatCoherefrom langchain_core.messages import HumanMessagechat = ChatCohere()messages = [HumanMessage(content="knock knock")]print(chat.invoke(messages))
```

**API Reference:**[HumanMessage](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.human.HumanMessage.html)

Usage of the Cohere [chat model](/src/oss/integrations/chat/cohere)

### LLM

```
from langchain_cohere.llms import Coherellm = Cohere()print(llm.invoke("Come up with a pet name"))
```

Usage of the Cohere (legacy) [LLM model](/src/oss/integrations/llms/cohere)

### Tool calling

```
from langchain_cohere import ChatCoherefrom langchain_core.messages import (    HumanMessage,    ToolMessage,)from langchain_core.tools import tool@tooldef magic_function(number: int) -> int:    """Applies a magic operation to an integer    Args:        number: Number to have magic operation performed on    """    return number + 10def invoke_tools(tool_calls, messages):    for tool_call in tool_calls:        selected_tool = {"magic_function":magic_function}[            tool_call["name"].lower()        ]        tool_output = selected_tool.invoke(tool_call["args"])        messages.append(ToolMessage(tool_output, tool_call_id=tool_call["id"]))    return messagestools = [magic_function]llm = ChatCohere()llm_with_tools = llm.bind_tools(tools=tools)messages = [    HumanMessage(        content="What is the value of magic_function(2)?"    )]res = llm_with_tools.invoke(messages)while res.tool_calls:    messages.append(res)    messages = invoke_tools(res.tool_calls, messages)    res = llm_with_tools.invoke(messages)print(res.content)
```

**API Reference:**[HumanMessage](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.human.HumanMessage.html) | [ToolMessage](https://python.langchain.com/api_reference/core/messages/langchain_core.messages.tool.ToolMessage.html) | [tool](https://python.langchain.com/api_reference/core/tools/langchain_core.tools.convert.tool.html)

Tool calling with Cohere LLM can be done by binding the necessary tools to the llm as seen above. An alternative, is to support multi hop tool calling with the ReAct agent as seen below.

### ReAct Agent

The agent is based on the paper [ReAct: Synergizing Reasoning and Acting in Language Models](https://arxiv.org/abs/2210.03629).

```
from langchain_community.tools.tavily_search import TavilySearchResultsfrom langchain_cohere import ChatCohere, create_cohere_react_agentfrom langchain_core.prompts import ChatPromptTemplatefrom langchain.agents import AgentExecutorllm = ChatCohere()internet_search = TavilySearchResults(max_results=4)internet_search.name = "internet_search"internet_search.description = "Route a user query to the internet"prompt = ChatPromptTemplate.from_template("{input}")agent = create_cohere_react_agent(    llm,    [internet_search],    prompt)agent_executor = AgentExecutor(agent=agent, tools=[internet_search], verbose=True)agent_executor.invoke({    "input": "In what year was the company that was founded as Sound of Music added to the S&P 500?",})
```

**API Reference:**[TavilySearchResults](https://python.langchain.com/api_reference/community/tools/langchain_community.tools.tavily_search.tool.TavilySearchResults.html) | [ChatPromptTemplate](https://python.langchain.com/api_reference/core/prompts/langchain_core.prompts.chat.ChatPromptTemplate.html) | [AgentExecutor](https://python.langchain.com/api_reference/langchain/agents/langchain.agents.agent.AgentExecutor.html)

The ReAct agent can be used to call multiple tools in sequence.

### RAG Retriever

```
from langchain_cohere import ChatCoherefrom langchain.retrievers import CohereRagRetrieverfrom langchain_core.documents import Documentrag = CohereRagRetriever(llm=ChatCohere())print(rag.invoke("What is cohere ai?"))
```

**API Reference:**[CohereRagRetriever](https://python.langchain.com/api_reference/community/retrievers/langchain_community.retrievers.cohere_rag_retriever.CohereRagRetriever.html) | [Document](https://python.langchain.com/api_reference/core/documents/langchain_core.documents.base.Document.html)

Usage of the Cohere [RAG Retriever](/src/oss/integrations/retrievers/cohere)

### Text Embedding

```
from langchain_cohere import CohereEmbeddingsembeddings = CohereEmbeddings(model="embed-english-light-v3.0")print(embeddings.embed_documents(["This is a test document."]))
```

Usage of the Cohere [Text Embeddings model](/src/oss/integrations/text_embedding/cohere)

### Reranker

Usage of the Cohere [Reranker](/src/oss/integrations/retrievers/cohere-reranker)
